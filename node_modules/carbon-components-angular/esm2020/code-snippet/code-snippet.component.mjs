import { Component, Input, HostBinding, ViewChild } from "@angular/core";
import { BaseIconButton } from "carbon-components-angular/button";
import * as i0 from "@angular/core";
import * as i1 from "carbon-components-angular/i18n";
import * as i2 from "carbon-components-angular/utils";
import * as i3 from "@angular/common";
import * as i4 from "carbon-components-angular/button";
import * as i5 from "carbon-components-angular/icon";
export var SnippetType;
(function (SnippetType) {
    SnippetType["single"] = "single";
    SnippetType["multi"] = "multi";
    SnippetType["inline"] = "inline";
})(SnippetType || (SnippetType = {}));
/**
 * [See demo](../../?path=/story/components-code-snippet--basic)
 *
 * ```html
 * <cds-code-snippet>Code</cds-code-snippet>
 * ```
 */
export class CodeSnippet extends BaseIconButton {
    /**
     * Creates an instance of CodeSnippet.
     */
    constructor(i18n, eventService) {
        super();
        this.i18n = i18n;
        this.eventService = eventService;
        this.rowHeightInPixel = 16;
        /**
         * It can be `"single"`, `"multi"` or `"inline"`
         */
        this.display = SnippetType.single;
        this.translations = this.i18n.get().CODE_SNIPPET;
        /**
         * Set to `true` to hide copy button
         */
        this.hideCopyButton = false;
        /**
         * Set to `true` to disable the code snippet
         */
        this.disabled = false;
        /**
         * Specify the max number of rows to show when collapsed
         * Default is `15`
         */
        this.maxCollapsedNumberOfRows = 15;
        /**
         * Specify the min number of rows to show when collapsed
         * Default is `3`
         */
        this.minCollapsedNumberOfRows = 3;
        /**
         * Specify the max number of rows to show when expanded
         * Default is `0`, hence all content will be visible when expanded
         */
        this.maxExpandedNumberOfRows = 0;
        /**
         * Specify the min number of rows to show when expanded
         * Default is `16`, hence height of expanded row will be 16 * rowHeightInPixel (16) =  256px
         */
        this.minExpandedNumberOfRows = 16;
        /**
         * Set to `true` to wrap the text
         */
        this.wrapText = false;
        /**
         * @deprecated since v5 - Use `cdsLayer` directive instead
         * Set to `"light"` to apply the light style
         */
        this.theme = "dark";
        /**
         * Text displayed in the tooltip when user clicks button to copy code.
         */
        this.feedbackText = this.translations.COPIED;
        /**
         * Time in miliseconds to keep the feedback tooltip displayed.
         * Defaults to 2 seconds
         */
        this.feedbackTimeout = 2000;
        this.expanded = false;
        this.skeleton = false;
        this.styles = {};
        this.showFeedback = false;
        this.animating = false;
        this.hasExpandButton = null;
        this.isExpandable = false;
        this.hasRightOverflow = false;
        this.hasRight = false;
        this.hasLeft = false;
        this.dropShadow = false;
    }
    get snippetClass() {
        return this.display !== SnippetType.inline;
    }
    get snippetSingleClass() {
        return this.display === SnippetType.single;
    }
    get snippetMultiClass() {
        return this.display === SnippetType.multi;
    }
    get snippetDisabledClass() {
        return this.display !== "inline" && this.disabled;
    }
    get snippetInlineLightClass() {
        return this.theme === "light";
    }
    handleScroll() {
        let ref;
        switch (this.display) {
            case "multi":
                ref = this.codeContent.nativeElement;
                break;
            case "single":
                ref = this.codeContainer.nativeElement;
                break;
            default:
                return;
        }
        if (ref) {
            const { scrollWidth, clientWidth, scrollLeft } = ref;
            const horizontalOverflow = scrollWidth > clientWidth;
            this.hasLeft = horizontalOverflow && !!scrollLeft;
            this.hasRight = horizontalOverflow && scrollLeft + clientWidth !== scrollWidth;
        }
    }
    toggleSnippetExpansion() {
        this.expanded = !this.expanded;
        this.calculateContainerHeight();
    }
    onCopyButtonClicked() {
        if (!this.disabled) {
            window.navigator.clipboard
                .writeText(this.code.nativeElement.innerText || this.code.nativeElement.textContent).then(() => {
                this.showFeedback = true;
                this.animating = true;
                setTimeout(() => {
                    this.showFeedback = false;
                    this.animating = false;
                }, this.feedbackTimeout);
            });
        }
    }
    ngOnInit() {
        this.calculateContainerHeight();
        if (window) {
            this.eventService.on(window, "resize", () => {
                this.canExpand();
                this.handleScroll();
            });
        }
    }
    ngAfterViewInit() {
        setTimeout(() => {
            this.canExpand();
            this.handleScroll();
        });
    }
    calculateContainerHeight() {
        if (this.display === "multi") {
            this.styles = {};
            if (this.expanded) {
                if (this.maxExpandedNumberOfRows > 0) {
                    this.styles["max-height"] = `${this.maxExpandedNumberOfRows * this.rowHeightInPixel}px`;
                }
                if (this.minExpandedNumberOfRows > 0) {
                    this.styles["min-height"] = `${this.minExpandedNumberOfRows * this.rowHeightInPixel}px`;
                }
            }
            else {
                if (this.maxCollapsedNumberOfRows > 0) {
                    this.styles["max-height"] = `${this.maxCollapsedNumberOfRows * this.rowHeightInPixel}px`;
                }
                if (this.minCollapsedNumberOfRows > 0) {
                    this.styles["min-height"] = `${this.minCollapsedNumberOfRows * this.rowHeightInPixel}px`;
                }
            }
        }
    }
    canExpand() {
        if (this.display === "multi") {
            const height = this.codeContent.nativeElement.getBoundingClientRect().height;
            if (this.maxCollapsedNumberOfRows > 0 &&
                (this.maxExpandedNumberOfRows <= 0 ||
                    this.maxExpandedNumberOfRows > this.maxCollapsedNumberOfRows) &&
                height > this.maxCollapsedNumberOfRows * this.rowHeightInPixel) {
                this.isExpandable = true;
            }
            else {
                this.isExpandable = false;
            }
            if (this.expanded &&
                this.minExpandedNumberOfRows > 0 &&
                height <= this.minExpandedNumberOfRows * this.rowHeightInPixel) {
                this.isExpandable = false;
            }
        }
    }
}
CodeSnippet.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.3.0", ngImport: i0, type: CodeSnippet, deps: [{ token: i1.I18n }, { token: i2.EventService }], target: i0.ɵɵFactoryTarget.Component });
CodeSnippet.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.3.0", type: CodeSnippet, selector: "cds-code-snippet, ibm-code-snippet", inputs: { display: "display", translations: "translations", copyButtonDescription: "copyButtonDescription", hideCopyButton: "hideCopyButton", disabled: "disabled", maxCollapsedNumberOfRows: "maxCollapsedNumberOfRows", minCollapsedNumberOfRows: "minCollapsedNumberOfRows", maxExpandedNumberOfRows: "maxExpandedNumberOfRows", minExpandedNumberOfRows: "minExpandedNumberOfRows", wrapText: "wrapText", theme: "theme", feedbackText: "feedbackText", feedbackTimeout: "feedbackTimeout", expanded: "expanded", skeleton: "skeleton" }, host: { properties: { "class.cds--snippet": "this.snippetClass", "class.cds--snippet--single": "this.snippetSingleClass", "class.cds--snippet--multi": "this.snippetMultiClass", "class.cds--snippet--disabled": "this.snippetDisabledClass", "class.cds--snippet--light": "this.snippetInlineLightClass", "class.cds--snippet--wraptext": "this.wrapText", "class.cds--snippet--expand": "this.expanded", "class.cds--skeleton": "this.skeleton" } }, viewQueries: [{ propertyName: "code", first: true, predicate: ["code"], descendants: true }, { propertyName: "codeContent", first: true, predicate: ["codeContent"], descendants: true }, { propertyName: "codeContainer", first: true, predicate: ["codeContainer"], descendants: true }], usesInheritance: true, ngImport: i0, template: `
		<ng-container *ngIf="display === 'inline'; else notInline">
			<ng-container *ngIf="!hideCopyButton; else noBtnInline">
				<ng-container *ngTemplateOutlet="buttonTemplate"></ng-container>
			</ng-container>
			<ng-template #noBtnInline>
				<span
					class="cds--snippet cds--snippet--inline cds--snippet--no-copy"
					[ngClass]="{
						'cds--snippet--light': theme === 'light'
					}">
					<ng-container *ngTemplateOutlet="codeTemplate"></ng-container>
				</span>
			</ng-template>
		</ng-container>

		<ng-template #notInline>
			<div
				#codeContainer
				class="cds--snippet-container"
				[attr.aria-label]="translations.CODE_SNIPPET_TEXT"
				[attr.tabindex]="display === 'single' && !disabled ? '0' : null"
				[attr.role]="display==='single' ? 'textarea' : null"
				[ngStyle]="styles"
				(scroll)="(display === 'single' ? handleScroll() : null)">
				<ng-container *ngIf="skeleton">
					<span *ngIf="display === 'single'; else multiSkeleton"></span>
					<ng-template #multiSkeleton>
						<span></span>
						<span></span>
						<span></span>
					</ng-template>
				</ng-container>
				<pre
					#codeContent
					*ngIf="!skeleton"
					(scroll)="(display === 'multi' ? handleScroll() : null)"><ng-container *ngTemplateOutlet="codeTemplate"></ng-container></pre>
			</div>
			<div *ngIf="hasLeft" class="cds--snippet__overflow-indicator--left"></div>
			<div *ngIf="hasRight" class="cds--snippet__overflow-indicator--right"></div>
			<ng-container *ngTemplateOutlet="buttonTemplate"></ng-container>
			<button
				*ngIf="isExpandable"
				class="cds--btn cds--btn--ghost cds--btn--sm cds--snippet-btn--expand"
				(click)="toggleSnippetExpansion()"
				type="button">
				<span class="cds--snippet-btn--text">{{expanded ? translations.SHOW_LESS : translations.SHOW_MORE}}</span>
				<svg cdsIcon="chevron--down" size="16" class="cds--icon-chevron--down" [attr.aria-label]="translations.SHOW_MORE_ICON"></svg>
			</button>
		</ng-template>

		<ng-template #buttonTemplate>
			<cds-icon-button
				*ngIf="!skeleton"
				[description]="showFeedback ? feedbackText : copyButtonDescription"
				[align]="align"
				[dropShadow]="dropShadow"
				[caret]="caret"
				[highContrast]="highContrast"
				[isOpen]="isOpen"
				[enterDelayMs]="enterDelayMs"
				[leaveDelayMs]="leaveDelayMs"
				type="button"
				kind="primary"
				size="md"
				(click)="onCopyButtonClicked($event)"
				[buttonNgClass]="{
					'cds--snippet--light': theme === 'light',
					'cds--snippet--inline': display === 'inline',
					'cds--btn--icon-only': display !== 'inline',
					'cds--copy-btn': display !== 'inline',
					'cds--copy-btn--animating': animating,
					'cds--copy-btn--fade-in': showFeedback,
					'cds--copy-btn--fade-out': !showFeedback && animating,
					'cds--snippet cds--copy': true
				}"
				[buttonAttributes]="{
					'aria-label': translations.COPY_CODE,
					'aria-live': 'polite',
					'tabindex': '0'
				}">
				<ng-container *ngIf="display === 'inline'">
					<ng-container *ngTemplateOutlet="codeTemplate"></ng-container>
				</ng-container>
				<ng-container *ngIf="display !== 'inline'">
					<svg cdsIcon="copy" size="16" class="cds--snippet__icon"></svg>
				</ng-container>
			</cds-icon-button>
		</ng-template>

		<ng-template #codeTemplate>
			<code #code><ng-content></ng-content></code>
		</ng-template>
	`, isInline: true, dependencies: [{ kind: "directive", type: i3.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i3.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "directive", type: i3.NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }, { kind: "component", type: i4.IconButton, selector: "cds-icon-button, ibm-icon-button", inputs: ["buttonNgClass", "buttonAttributes", "buttonId", "kind", "size", "type", "isExpressive", "disabled", "description"], outputs: ["click", "focus", "blur", "tooltipClick"] }, { kind: "directive", type: i5.IconDirective, selector: "[cdsIcon], [ibmIcon]", inputs: ["ibmIcon", "cdsIcon", "size", "title", "ariaLabel", "ariaLabelledBy", "ariaHidden", "isFocusable"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.3.0", ngImport: i0, type: CodeSnippet, decorators: [{
            type: Component,
            args: [{
                    selector: "cds-code-snippet, ibm-code-snippet",
                    template: `
		<ng-container *ngIf="display === 'inline'; else notInline">
			<ng-container *ngIf="!hideCopyButton; else noBtnInline">
				<ng-container *ngTemplateOutlet="buttonTemplate"></ng-container>
			</ng-container>
			<ng-template #noBtnInline>
				<span
					class="cds--snippet cds--snippet--inline cds--snippet--no-copy"
					[ngClass]="{
						'cds--snippet--light': theme === 'light'
					}">
					<ng-container *ngTemplateOutlet="codeTemplate"></ng-container>
				</span>
			</ng-template>
		</ng-container>

		<ng-template #notInline>
			<div
				#codeContainer
				class="cds--snippet-container"
				[attr.aria-label]="translations.CODE_SNIPPET_TEXT"
				[attr.tabindex]="display === 'single' && !disabled ? '0' : null"
				[attr.role]="display==='single' ? 'textarea' : null"
				[ngStyle]="styles"
				(scroll)="(display === 'single' ? handleScroll() : null)">
				<ng-container *ngIf="skeleton">
					<span *ngIf="display === 'single'; else multiSkeleton"></span>
					<ng-template #multiSkeleton>
						<span></span>
						<span></span>
						<span></span>
					</ng-template>
				</ng-container>
				<pre
					#codeContent
					*ngIf="!skeleton"
					(scroll)="(display === 'multi' ? handleScroll() : null)"><ng-container *ngTemplateOutlet="codeTemplate"></ng-container></pre>
			</div>
			<div *ngIf="hasLeft" class="cds--snippet__overflow-indicator--left"></div>
			<div *ngIf="hasRight" class="cds--snippet__overflow-indicator--right"></div>
			<ng-container *ngTemplateOutlet="buttonTemplate"></ng-container>
			<button
				*ngIf="isExpandable"
				class="cds--btn cds--btn--ghost cds--btn--sm cds--snippet-btn--expand"
				(click)="toggleSnippetExpansion()"
				type="button">
				<span class="cds--snippet-btn--text">{{expanded ? translations.SHOW_LESS : translations.SHOW_MORE}}</span>
				<svg cdsIcon="chevron--down" size="16" class="cds--icon-chevron--down" [attr.aria-label]="translations.SHOW_MORE_ICON"></svg>
			</button>
		</ng-template>

		<ng-template #buttonTemplate>
			<cds-icon-button
				*ngIf="!skeleton"
				[description]="showFeedback ? feedbackText : copyButtonDescription"
				[align]="align"
				[dropShadow]="dropShadow"
				[caret]="caret"
				[highContrast]="highContrast"
				[isOpen]="isOpen"
				[enterDelayMs]="enterDelayMs"
				[leaveDelayMs]="leaveDelayMs"
				type="button"
				kind="primary"
				size="md"
				(click)="onCopyButtonClicked($event)"
				[buttonNgClass]="{
					'cds--snippet--light': theme === 'light',
					'cds--snippet--inline': display === 'inline',
					'cds--btn--icon-only': display !== 'inline',
					'cds--copy-btn': display !== 'inline',
					'cds--copy-btn--animating': animating,
					'cds--copy-btn--fade-in': showFeedback,
					'cds--copy-btn--fade-out': !showFeedback && animating,
					'cds--snippet cds--copy': true
				}"
				[buttonAttributes]="{
					'aria-label': translations.COPY_CODE,
					'aria-live': 'polite',
					'tabindex': '0'
				}">
				<ng-container *ngIf="display === 'inline'">
					<ng-container *ngTemplateOutlet="codeTemplate"></ng-container>
				</ng-container>
				<ng-container *ngIf="display !== 'inline'">
					<svg cdsIcon="copy" size="16" class="cds--snippet__icon"></svg>
				</ng-container>
			</cds-icon-button>
		</ng-template>

		<ng-template #codeTemplate>
			<code #code><ng-content></ng-content></code>
		</ng-template>
	`
                }]
        }], ctorParameters: function () { return [{ type: i1.I18n }, { type: i2.EventService }]; }, propDecorators: { snippetClass: [{
                type: HostBinding,
                args: ["class.cds--snippet"]
            }], snippetSingleClass: [{
                type: HostBinding,
                args: ["class.cds--snippet--single"]
            }], snippetMultiClass: [{
                type: HostBinding,
                args: ["class.cds--snippet--multi"]
            }], snippetDisabledClass: [{
                type: HostBinding,
                args: ["class.cds--snippet--disabled"]
            }], snippetInlineLightClass: [{
                type: HostBinding,
                args: ["class.cds--snippet--light"]
            }], display: [{
                type: Input
            }], translations: [{
                type: Input
            }], copyButtonDescription: [{
                type: Input
            }], hideCopyButton: [{
                type: Input
            }], disabled: [{
                type: Input
            }], maxCollapsedNumberOfRows: [{
                type: Input
            }], minCollapsedNumberOfRows: [{
                type: Input
            }], maxExpandedNumberOfRows: [{
                type: Input
            }], minExpandedNumberOfRows: [{
                type: Input
            }], wrapText: [{
                type: HostBinding,
                args: ["class.cds--snippet--wraptext"]
            }, {
                type: Input
            }], theme: [{
                type: Input
            }], feedbackText: [{
                type: Input
            }], feedbackTimeout: [{
                type: Input
            }], expanded: [{
                type: HostBinding,
                args: ["class.cds--snippet--expand"]
            }, {
                type: Input
            }], skeleton: [{
                type: HostBinding,
                args: ["class.cds--skeleton"]
            }, {
                type: Input
            }], code: [{
                type: ViewChild,
                args: ["code"]
            }], codeContent: [{
                type: ViewChild,
                args: ["codeContent"]
            }], codeContainer: [{
                type: ViewChild,
                args: ["codeContainer"]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29kZS1zbmlwcGV0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb2RlLXNuaXBwZXQvY29kZS1zbmlwcGV0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ04sU0FBUyxFQUNULEtBQUssRUFDTCxXQUFXLEVBQ1gsU0FBUyxFQUdULE1BQU0sZUFBZSxDQUFDO0FBSXZCLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQzs7Ozs7OztBQUVsRSxNQUFNLENBQU4sSUFBWSxXQUlYO0FBSkQsV0FBWSxXQUFXO0lBQ3RCLGdDQUFpQixDQUFBO0lBQ2pCLDhCQUFlLENBQUE7SUFDZixnQ0FBaUIsQ0FBQTtBQUNsQixDQUFDLEVBSlcsV0FBVyxLQUFYLFdBQVcsUUFJdEI7QUFFRDs7Ozs7O0dBTUc7QUFrR0gsTUFBTSxPQUFPLFdBQVksU0FBUSxjQUFjO0lBNEY5Qzs7T0FFRztJQUNILFlBQXNCLElBQVUsRUFBWSxZQUEwQjtRQUNyRSxLQUFLLEVBQUUsQ0FBQztRQURhLFNBQUksR0FBSixJQUFJLENBQU07UUFBWSxpQkFBWSxHQUFaLFlBQVksQ0FBYztRQTlFN0QscUJBQWdCLEdBQVcsRUFBRSxDQUFDO1FBRXZDOztXQUVHO1FBQ00sWUFBTyxHQUFnQixXQUFXLENBQUMsTUFBTSxDQUFDO1FBQzFDLGlCQUFZLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUM7UUFLckQ7O1dBRUc7UUFDTSxtQkFBYyxHQUFHLEtBQUssQ0FBQztRQUNoQzs7V0FFRztRQUNNLGFBQVEsR0FBRyxLQUFLLENBQUM7UUFDMUI7OztXQUdHO1FBQ00sNkJBQXdCLEdBQUcsRUFBRSxDQUFDO1FBQ3ZDOzs7V0FHRztRQUNNLDZCQUF3QixHQUFHLENBQUMsQ0FBQztRQUN0Qzs7O1dBR0c7UUFDTSw0QkFBdUIsR0FBRyxDQUFDLENBQUM7UUFDckM7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dUJBQUMsNEJBQTRCOztzQkFBRyxLQUFLO2dCQUNKLFFBQVE7c0JBQXBELFdBQVc7dUJBQUMscUJBQXFCOztzQkFBRyxLQUFLO2dCQUd2QixJQUFJO3NCQUF0QixTQUFTO3VCQUFDLE1BQU07Z0JBQ1MsV0FBVztzQkFBcEMsU0FBUzt1QkFBQyxhQUFhO2dCQUNJLGFBQWE7c0JBQXhDLFNBQVM7dUJBQUMsZUFBZSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG5cdENvbXBvbmVudCxcblx0SW5wdXQsXG5cdEhvc3RCaW5kaW5nLFxuXHRWaWV3Q2hpbGQsXG5cdEFmdGVyVmlld0luaXQsXG5cdE9uSW5pdFxufSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuXG5pbXBvcnQgeyBJMThuIH0gZnJvbSBcImNhcmJvbi1jb21wb25lbnRzLWFuZ3VsYXIvaTE4blwiO1xuaW1wb3J0IHsgRXZlbnRTZXJ2aWNlIH0gZnJvbSBcImNhcmJvbi1jb21wb25lbnRzLWFuZ3VsYXIvdXRpbHNcIjtcbmltcG9ydCB7IEJhc2VJY29uQnV0dG9uIH0gZnJvbSBcImNhcmJvbi1jb21wb25lbnRzLWFuZ3VsYXIvYnV0dG9uXCI7XG5cbmV4cG9ydCBlbnVtIFNuaXBwZXRUeXBlIHtcblx0c2luZ2xlID0gXCJzaW5nbGVcIixcblx0bXVsdGkgPSBcIm11bHRpXCIsXG5cdGlubGluZSA9IFwiaW5saW5lXCJcbn1cblxuLyoqXG4gKiBbU2VlIGRlbW9dKC4uLy4uLz9wYXRoPS9zdG9yeS9jb21wb25lbnRzLWNvZGUtc25pcHBldC0tYmFzaWMpXG4gKlxuICogYGBgaHRtbFxuICogPGNkcy1jb2RlLXNuaXBwZXQ+Q29kZTwvY2RzLWNvZGUtc25pcHBldD5cbiAqIGBgYFxuICovXG5AQ29tcG9uZW50KHtcblx0c2VsZWN0b3I6IFwiY2RzLWNvZGUtc25pcHBldCwgaWJtLWNvZGUtc25pcHBldFwiLFxuXHR0ZW1wbGF0ZTogYFxuXHRcdDxuZy1jb250YWluZXIgKm5nSWY9XCJkaXNwbGF5ID09PSAnaW5saW5lJzsgZWxzZSBub3RJbmxpbmVcIj5cblx0XHRcdDxuZy1jb250YWluZXIgKm5nSWY9XCIhaGlkZUNvcHlCdXR0b247IGVsc2Ugbm9CdG5JbmxpbmVcIj5cblx0XHRcdFx0PG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cImJ1dHRvblRlbXBsYXRlXCI+PC9uZy1jb250YWluZXI+XG5cdFx0XHQ8L25nLWNvbnRhaW5lcj5cblx0XHRcdDxuZy10ZW1wbGF0ZSAjbm9CdG5JbmxpbmU+XG5cdFx0XHRcdDxzcGFuXG5cdFx0XHRcdFx0Y2xhc3M9XCJjZHMtLXNuaXBwZXQgY2RzLS1zbmlwcGV0LS1pbmxpbmUgY2RzLS1zbmlwcGV0LS1uby1jb3B5XCJcblx0XHRcdFx0XHRbbmdDbGFzc109XCJ7XG5cdFx0XHRcdFx0XHQnY2RzLS1zbmlwcGV0LS1saWdodCc6IHRoZW1lID09PSAnbGlnaHQnXG5cdFx0XHRcdFx0fVwiPlxuXHRcdFx0XHRcdDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJjb2RlVGVtcGxhdGVcIj48L25nLWNvbnRhaW5lcj5cblx0XHRcdFx0PC9zcGFuPlxuXHRcdFx0PC9uZy10ZW1wbGF0ZT5cblx0XHQ8L25nLWNvbnRhaW5lcj5cblxuXHRcdDxuZy10ZW1wbGF0ZSAjbm90SW5saW5lPlxuXHRcdFx0PGRpdlxuXHRcdFx0XHQjY29kZUNvbnRhaW5lclxuXHRcdFx0XHRjbGFzcz1cImNkcy0tc25pcHBldC1jb250YWluZXJcIlxuXHRcdFx0XHRbYXR0ci5hcmlhLWxhYmVsXT1cInRyYW5zbGF0aW9ucy5DT0RFX1NOSVBQRVRfVEVYVFwiXG5cdFx0XHRcdFthdHRyLnRhYmluZGV4XT1cImRpc3BsYXkgPT09ICdzaW5nbGUnICYmICFkaXNhYmxlZCA/ICcwJyA6IG51bGxcIlxuXHRcdFx0XHRbYXR0ci5yb2xlXT1cImRpc3BsYXk9PT0nc2luZ2xlJyA/ICd0ZXh0YXJlYScgOiBudWxsXCJcblx0XHRcdFx0W25nU3R5bGVdPVwic3R5bGVzXCJcblx0XHRcdFx0KHNjcm9sbCk9XCIoZGlzcGxheSA9PT0gJ3NpbmdsZScgPyBoYW5kbGVTY3JvbGwoKSA6IG51bGwpXCI+XG5cdFx0XHRcdDxuZy1jb250YWluZXIgKm5nSWY9XCJza2VsZXRvblwiPlxuXHRcdFx0XHRcdDxzcGFuICpuZ0lmPVwiZGlzcGxheSA9PT0gJ3NpbmdsZSc7IGVsc2UgbXVsdGlTa2VsZXRvblwiPjwvc3Bhbj5cblx0XHRcdFx0XHQ8bmctdGVtcGxhdGUgI211bHRpU2tlbGV0b24+XG5cdFx0XHRcdFx0XHQ8c3Bhbj48L3NwYW4+XG5cdFx0XHRcdFx0XHQ8c3Bhbj48L3NwYW4+XG5cdFx0XHRcdFx0XHQ8c3Bhbj48L3NwYW4+XG5cdFx0XHRcdFx0PC9uZy10ZW1wbGF0ZT5cblx0XHRcdFx0PC9uZy1jb250YWluZXI+XG5cdFx0XHRcdDxwcmVcblx0XHRcdFx0XHQjY29kZUNvbnRlbnRcblx0XHRcdFx0XHQqbmdJZj1cIiFza2VsZXRvblwiXG5cdFx0XHRcdFx0KHNjcm9sbCk9XCIoZGlzcGxheSA9PT0gJ211bHRpJyA/IGhhbmRsZVNjcm9sbCgpIDogbnVsbClcIj48bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwiY29kZVRlbXBsYXRlXCI+PC9uZy1jb250YWluZXI+PC9wcmU+XG5cdFx0XHQ8L2Rpdj5cblx0XHRcdDxkaXYgKm5nSWY9XCJoYXNMZWZ0XCIgY2xhc3M9XCJjZHMtLXNuaXBwZXRfX292ZXJmbG93LWluZGljYXRvci0tbGVmdFwiPjwvZGl2PlxuXHRcdFx0PGRpdiAqbmdJZj1cImhhc1JpZ2h0XCIgY2xhc3M9XCJjZHMtLXNuaXBwZXRfX292ZXJmbG93LWluZGljYXRvci0tcmlnaHRcIj48L2Rpdj5cblx0XHRcdDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJidXR0b25UZW1wbGF0ZVwiPjwvbmctY29udGFpbmVyPlxuXHRcdFx0PGJ1dHRvblxuXHRcdFx0XHQqbmdJZj1cImlzRXhwYW5kYWJsZVwiXG5cdFx0XHRcdGNsYXNzPVwiY2RzLS1idG4gY2RzLS1idG4tLWdob3N0IGNkcy0tYnRuLS1zbSBjZHMtLXNuaXBwZXQtYnRuLS1leHBhbmRcIlxuXHRcdFx0XHQoY2xpY2spPVwidG9nZ2xlU25pcHBldEV4cGFuc2lvbigpXCJcblx0XHRcdFx0dHlwZT1cImJ1dHRvblwiPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cImNkcy0tc25pcHBldC1idG4tLXRleHRcIj57e2V4cGFuZGVkID8gdHJhbnNsYXRpb25zLlNIT1dfTEVTUyA6IHRyYW5zbGF0aW9ucy5TSE9XX01PUkV9fTwvc3Bhbj5cblx0XHRcdFx0PHN2ZyBjZHNJY29uPVwiY2hldnJvbi0tZG93blwiIHNpemU9XCIxNlwiIGNsYXNzPVwiY2RzLS1pY29uLWNoZXZyb24tLWRvd25cIiBbYXR0ci5hcmlhLWxhYmVsXT1cInRyYW5zbGF0aW9ucy5TSE9XX01PUkVfSUNPTlwiPjwvc3ZnPlxuXHRcdFx0PC9idXR0b24+XG5cdFx0PC9uZy10ZW1wbGF0ZT5cblxuXHRcdDxuZy10ZW1wbGF0ZSAjYnV0dG9uVGVtcGxhdGU+XG5cdFx0XHQ8Y2RzLWljb24tYnV0dG9uXG5cdFx0XHRcdCpuZ0lmPVwiIXNrZWxldG9uXCJcblx0XHRcdFx0W2Rlc2NyaXB0aW9uXT1cInNob3dGZWVkYmFjayA/IGZlZWRiYWNrVGV4dCA6IGNvcHlCdXR0b25EZXNjcmlwdGlvblwiXG5cdFx0XHRcdFthbGlnbl09XCJhbGlnblwiXG5cdFx0XHRcdFtkcm9wU2hhZG93XT1cImRyb3BTaGFkb3dcIlxuXHRcdFx0XHRbY2FyZXRdPVwiY2FyZXRcIlxuXHRcdFx0XHRbaGlnaENvbnRyYXN0XT1cImhpZ2hDb250cmFzdFwiXG5cdFx0XHRcdFtpc09wZW5dPVwiaXNPcGVuXCJcblx0XHRcdFx0W2VudGVyRGVsYXlNc109XCJlbnRlckRlbGF5TXNcIlxuXHRcdFx0XHRbbGVhdmVEZWxheU1zXT1cImxlYXZlRGVsYXlNc1wiXG5cdFx0XHRcdHR5cGU9XCJidXR0b25cIlxuXHRcdFx0XHRraW5kPVwicHJpbWFyeVwiXG5cdFx0XHRcdHNpemU9XCJtZFwiXG5cdFx0XHRcdChjbGljayk9XCJvbkNvcHlCdXR0b25DbGlja2VkKCRldmVudClcIlxuXHRcdFx0XHRbYnV0dG9uTmdDbGFzc109XCJ7XG5cdFx0XHRcdFx0J2Nkcy0tc25pcHBldC0tbGlnaHQnOiB0aGVtZSA9PT0gJ2xpZ2h0Jyxcblx0XHRcdFx0XHQnY2RzLS1zbmlwcGV0LS1pbmxpbmUnOiBkaXNwbGF5ID09PSAnaW5saW5lJyxcblx0XHRcdFx0XHQnY2RzLS1idG4tLWljb24tb25seSc6IGRpc3BsYXkgIT09ICdpbmxpbmUnLFxuXHRcdFx0XHRcdCdjZHMtLWNvcHktYnRuJzogZGlzcGxheSAhPT0gJ2lubGluZScsXG5cdFx0XHRcdFx0J2Nkcy0tY29weS1idG4tLWFuaW1hdGluZyc6IGFuaW1hdGluZyxcblx0XHRcdFx0XHQnY2RzLS1jb3B5LWJ0bi0tZmFkZS1pbic6IHNob3dGZWVkYmFjayxcblx0XHRcdFx0XHQnY2RzLS1jb3B5LWJ0bi0tZmFkZS1vdXQnOiAhc2hvd0ZlZWRiYWNrICYmIGFuaW1hdGluZyxcblx0XHRcdFx0XHQnY2RzLS1zbmlwcGV0IGNkcy0tY29weSc6IHRydWVcblx0XHRcdFx0fVwiXG5cdFx0XHRcdFtidXR0b25BdHRyaWJ1dGVzXT1cIntcblx0XHRcdFx0XHQnYXJpYS1sYWJlbCc6IHRyYW5zbGF0aW9ucy5DT1BZX0NPREUsXG5cdFx0XHRcdFx0J2FyaWEtbGl2ZSc6ICdwb2xpdGUnLFxuXHRcdFx0XHRcdCd0YWJpbmRleCc6ICcwJ1xuXHRcdFx0XHR9XCI+XG5cdFx0XHRcdDxuZy1jb250YWluZXIgKm5nSWY9XCJkaXNwbGF5ID09PSAnaW5saW5lJ1wiPlxuXHRcdFx0XHRcdDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJjb2RlVGVtcGxhdGVcIj48L25nLWNvbnRhaW5lcj5cblx0XHRcdFx0PC9uZy1jb250YWluZXI+XG5cdFx0XHRcdDxuZy1jb250YWluZXIgKm5nSWY9XCJkaXNwbGF5ICE9PSAnaW5saW5lJ1wiPlxuXHRcdFx0XHRcdDxzdmcgY2RzSWNvbj1cImNvcHlcIiBzaXplPVwiMTZcIiBjbGFzcz1cImNkcy0tc25pcHBldF9faWNvblwiPjwvc3ZnPlxuXHRcdFx0XHQ8L25nLWNvbnRhaW5lcj5cblx0XHRcdDwvY2RzLWljb24tYnV0dG9uPlxuXHRcdDwvbmctdGVtcGxhdGU+XG5cblx0XHQ8bmctdGVtcGxhdGUgI2NvZGVUZW1wbGF0ZT5cblx0XHRcdDxjb2RlICNjb2RlPjxuZy1jb250ZW50PjwvbmctY29udGVudD48L2NvZGU+XG5cdFx0PC9uZy10ZW1wbGF0ZT5cblx0YFxufSlcbmV4cG9ydCBjbGFzcyBDb2RlU25pcHBldCBleHRlbmRzIEJhc2VJY29uQnV0dG9uIGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0IHtcblx0QEhvc3RCaW5kaW5nKFwiY2xhc3MuY2RzLS1zbmlwcGV0XCIpIGdldCBzbmlwcGV0Q2xhc3MoKSB7XG5cdFx0cmV0dXJuIHRoaXMuZGlzcGxheSAhPT0gU25pcHBldFR5cGUuaW5saW5lO1xuXHR9XG5cdEBIb3N0QmluZGluZyhcImNsYXNzLmNkcy0tc25pcHBldC0tc2luZ2xlXCIpIGdldCBzbmlwcGV0U2luZ2xlQ2xhc3MoKSB7XG5cdFx0cmV0dXJuIHRoaXMuZGlzcGxheSA9PT0gU25pcHBldFR5cGUuc2luZ2xlO1xuXHR9XG5cdEBIb3N0QmluZGluZyhcImNsYXNzLmNkcy0tc25pcHBldC0tbXVsdGlcIikgZ2V0IHNuaXBwZXRNdWx0aUNsYXNzKCkge1xuXHRcdHJldHVybiB0aGlzLmRpc3BsYXkgPT09IFNuaXBwZXRUeXBlLm11bHRpO1xuXHR9XG5cdEBIb3N0QmluZGluZyhcImNsYXNzLmNkcy0tc25pcHBldC0tZGlzYWJsZWRcIikgZ2V0IHNuaXBwZXREaXNhYmxlZENsYXNzKCkge1xuXHRcdHJldHVybiB0aGlzLmRpc3BsYXkgIT09IFwiaW5saW5lXCIgJiYgdGhpcy5kaXNhYmxlZDtcblx0fVxuXHRASG9zdEJpbmRpbmcoXCJjbGFzcy5jZHMtLXNuaXBwZXQtLWxpZ2h0XCIpIGdldCBzbmlwcGV0SW5saW5lTGlnaHRDbGFzcygpIHtcblx0XHRyZXR1cm4gdGhpcy50aGVtZSA9PT0gXCJsaWdodFwiO1xuXHR9XG5cblx0cmVhZG9ubHkgcm93SGVpZ2h0SW5QaXhlbDogbnVtYmVyID0gMTY7XG5cblx0LyoqXG5cdCAqIEl0IGNhbiBiZSBgXCJzaW5nbGVcImAsIGBcIm11bHRpXCJgIG9yIGBcImlubGluZVwiYFxuXHQgKi9cblx0QElucHV0KCkgZGlzcGxheTogU25pcHBldFR5cGUgPSBTbmlwcGV0VHlwZS5zaW5nbGU7XG5cdEBJbnB1dCgpIHRyYW5zbGF0aW9ucyA9IHRoaXMuaTE4bi5nZXQoKS5DT0RFX1NOSVBQRVQ7XG5cdC8qKlxuXHQgKiBjb3B5IGJ1dHRvbiBkZXNjcmlwdGlvbiB0byBzaG93IG9uIGhvdmVyXG5cdCAqL1xuXHRASW5wdXQoKSBjb3B5QnV0dG9uRGVzY3JpcHRpb246IHN0cmluZztcblx0LyoqXG5cdCAqIFNldCB0byBgdHJ1ZWAgdG8gaGlkZSBjb3B5IGJ1dHRvblxuXHQgKi9cblx0QElucHV0KCkgaGlkZUNvcHlCdXR0b24gPSBmYWxzZTtcblx0LyoqXG5cdCAqIFNldCB0byBgdHJ1ZWAgdG8gZGlzYWJsZSB0aGUgY29kZSBzbmlwcGV0XG5cdCAqL1xuXHRASW5wdXQoKSBkaXNhYmxlZCA9IGZhbHNlO1xuXHQvKipcblx0ICogU3BlY2lmeSB0aGUgbWF4IG51bWJlciBvZiByb3dzIHRvIHNob3cgd2hlbiBjb2xsYXBzZWRcblx0ICogRGVmYXVsdCBpcyBgMTVgXG5cdCAqL1xuXHRASW5wdXQoKSBtYXhDb2xsYXBzZWROdW1iZXJPZlJvd3MgPSAxNTtcblx0LyoqXG5cdCAqIFNwZWNpZnkgdGhlIG1pbiBudW1iZXIgb2Ygcm93cyB0byBzaG93IHdoZW4gY29sbGFwc2VkXG5cdCAqIERlZmF1bHQgaXMgYDNgXG5cdCAqL1xuXHRASW5wdXQoKSBtaW5Db2xsYXBzZWROdW1iZXJPZlJvd3MgPSAzO1xuXHQvKipcblx0ICogU3BlY2lmeSB0aGUgbWF4IG51bWJlciBvZiByb3dzIHRvIHNob3cgd2hlbiBleHBhbmRlZFxuXHQgKiBEZWZhdWx0IGlzIGAwYCwgaGVuY2UgYWxsIGNvbnRlbnQgd2lsbCBiZSB2aXNpYmxlIHdoZW4gZXhwYW5kZWRcblx0ICovXG5cdEBJbnB1dCgpIG1heEV4cGFuZGVkTnVtYmVyT2ZSb3dzID0gMDtcblx0LyoqXG5cdCAqIFNwZWNpZnkgdGhlIG1pbiBudW1iZXIgb2Ygcm93cyB0byBzaG93IHdoZW4gZXhwYW5kZWRcblx0ICogRGVmYXVsdCBpcyBgMTZgLCBoZW5jZSBoZWlnaHQgb2YgZXhwYW5kZWQgcm93IHdpbGwgYmUgMTYgKiByb3dIZWlnaHRJblBpeGVsICgxNikgPSAgMjU2cHhcblx0ICovXG5cdEBJbnB1dCgpIG1pbkV4cGFuZGVkTnVtYmVyT2ZSb3dzID0gMTY7XG5cdC8qKlxuXHQgKiBTZXQgdG8gYHRydWVgIHRvIHdyYXAgdGhlIHRleHRcblx0ICovXG5cdEBIb3N0QmluZGluZyhcImNsYXNzLmNkcy0tc25pcHBldC0td3JhcHRleHRcIikgQElucHV0KCkgd3JhcFRleHQgPSBmYWxzZTtcblx0LyoqXG5cdCAqIEBkZXByZWNhdGVkIHNpbmNlIHY1IC0gVXNlIGBjZHNMYXllcmAgZGlyZWN0aXZlIGluc3RlYWRcblx0ICogU2V0IHRvIGBcImxpZ2h0XCJgIHRvIGFwcGx5IHRoZSBsaWdodCBzdHlsZVxuXHQgKi9cblx0QElucHV0KCkgdGhlbWU6IFwibGlnaHRcIiB8IFwiZGFya1wiID0gXCJkYXJrXCI7XG5cdC8qKlxuXHQgKiBUZXh0IGRpc3BsYXllZCBpbiB0aGUgdG9vbHRpcCB3aGVuIHVzZXIgY2xpY2tzIGJ1dHRvbiB0byBjb3B5IGNvZGUuXG5cdCAqL1xuXHRASW5wdXQoKSBmZWVkYmFja1RleHQgPSB0aGlzLnRyYW5zbGF0aW9ucy5DT1BJRUQ7XG5cdC8qKlxuXHQgKiBUaW1lIGluIG1pbGlzZWNvbmRzIHRvIGtlZXAgdGhlIGZlZWRiYWNrIHRvb2x0aXAgZGlzcGxheWVkLlxuXHQgKiBEZWZhdWx0cyB0byAyIHNlY29uZHNcblx0ICovXG5cdEBJbnB1dCgpIGZlZWRiYWNrVGltZW91dCA9IDIwMDA7XG5cblx0QEhvc3RCaW5kaW5nKFwiY2xhc3MuY2RzLS1zbmlwcGV0LS1leHBhbmRcIikgQElucHV0KCkgZXhwYW5kZWQgPSBmYWxzZTtcblx0QEhvc3RCaW5kaW5nKFwiY2xhc3MuY2RzLS1za2VsZXRvblwiKSBASW5wdXQoKSBza2VsZXRvbiA9IGZhbHNlO1xuXHRzdHlsZXM6IGFueSA9IHt9O1xuXG5cdEBWaWV3Q2hpbGQoXCJjb2RlXCIpIGNvZGU7XG5cdEBWaWV3Q2hpbGQoXCJjb2RlQ29udGVudFwiKSBjb2RlQ29udGVudDtcblx0QFZpZXdDaGlsZChcImNvZGVDb250YWluZXJcIikgY29kZUNvbnRhaW5lcjtcblxuXHRzaG93RmVlZGJhY2sgPSBmYWxzZTtcblx0YW5pbWF0aW5nID0gZmFsc2U7XG5cdGhhc0V4cGFuZEJ1dHRvbiA9IG51bGw7XG5cdGlzRXhwYW5kYWJsZSA9IGZhbHNlO1xuXHRoYXNSaWdodE92ZXJmbG93ID0gZmFsc2U7XG5cblx0aGFzUmlnaHQgPSBmYWxzZTtcblx0aGFzTGVmdCA9IGZhbHNlO1xuXG5cdC8qKlxuXHQgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIENvZGVTbmlwcGV0LlxuXHQgKi9cblx0Y29uc3RydWN0b3IocHJvdGVjdGVkIGkxOG46IEkxOG4sIHByb3RlY3RlZCBldmVudFNlcnZpY2U6IEV2ZW50U2VydmljZSkge1xuXHRcdHN1cGVyKCk7XG5cdFx0dGhpcy5kcm9wU2hhZG93ID0gZmFsc2U7XG5cdH1cblxuXHRoYW5kbGVTY3JvbGwoKSB7XG5cdFx0bGV0IHJlZjtcblx0XHRzd2l0Y2ggKHRoaXMuZGlzcGxheSkge1xuXHRcdFx0Y2FzZSBcIm11bHRpXCI6XG5cdFx0XHRcdHJlZiA9IHRoaXMuY29kZUNvbnRlbnQubmF0aXZlRWxlbWVudDtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwic2luZ2xlXCI6XG5cdFx0XHRcdHJlZiA9IHRoaXMuY29kZUNvbnRhaW5lci5uYXRpdmVFbGVtZW50O1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKHJlZikge1xuXHRcdFx0Y29uc3Qge1xuXHRcdFx0XHRzY3JvbGxXaWR0aCxcblx0XHRcdFx0Y2xpZW50V2lkdGgsXG5cdFx0XHRcdHNjcm9sbExlZnRcblx0XHRcdH0gPSByZWY7XG5cdFx0XHRjb25zdCBob3Jpem9udGFsT3ZlcmZsb3cgPSBzY3JvbGxXaWR0aCA+IGNsaWVudFdpZHRoO1xuXHRcdFx0dGhpcy5oYXNMZWZ0ID0gaG9yaXpvbnRhbE92ZXJmbG93ICYmICEhc2Nyb2xsTGVmdDtcblx0XHRcdHRoaXMuaGFzUmlnaHQgPSBob3Jpem9udGFsT3ZlcmZsb3cgJiYgc2Nyb2xsTGVmdCArIGNsaWVudFdpZHRoICE9PSBzY3JvbGxXaWR0aDtcblx0XHR9XG5cdH1cblxuXHR0b2dnbGVTbmlwcGV0RXhwYW5zaW9uKCkge1xuXHRcdHRoaXMuZXhwYW5kZWQgPSAhdGhpcy5leHBhbmRlZDtcblx0XHR0aGlzLmNhbGN1bGF0ZUNvbnRhaW5lckhlaWdodCgpO1xuXHR9XG5cblx0b25Db3B5QnV0dG9uQ2xpY2tlZCgpIHtcblx0XHRpZiAoIXRoaXMuZGlzYWJsZWQpIHtcblx0XHRcdHdpbmRvdy5uYXZpZ2F0b3IuY2xpcGJvYXJkXG5cdFx0XHRcdC53cml0ZVRleHQodGhpcy5jb2RlLm5hdGl2ZUVsZW1lbnQuaW5uZXJUZXh0IHx8IHRoaXMuY29kZS5uYXRpdmVFbGVtZW50LnRleHRDb250ZW50KS50aGVuKCgpID0+IHtcblx0XHRcdFx0XHR0aGlzLnNob3dGZWVkYmFjayA9IHRydWU7XG5cdFx0XHRcdFx0dGhpcy5hbmltYXRpbmcgPSB0cnVlO1xuXHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5zaG93RmVlZGJhY2sgPSBmYWxzZTtcblx0XHRcdFx0XHRcdHRoaXMuYW5pbWF0aW5nID0gZmFsc2U7XG5cdFx0XHRcdFx0fSwgdGhpcy5mZWVkYmFja1RpbWVvdXQpO1xuXHRcdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHRuZ09uSW5pdCgpIHtcblx0XHR0aGlzLmNhbGN1bGF0ZUNvbnRhaW5lckhlaWdodCgpO1xuXHRcdGlmICh3aW5kb3cpIHtcblx0XHRcdHRoaXMuZXZlbnRTZXJ2aWNlLm9uKHdpbmRvdyBhcyBhbnksIFwicmVzaXplXCIsICgpID0+IHtcblx0XHRcdFx0dGhpcy5jYW5FeHBhbmQoKTtcblx0XHRcdFx0dGhpcy5oYW5kbGVTY3JvbGwoKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdG5nQWZ0ZXJWaWV3SW5pdCgpIHtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuY2FuRXhwYW5kKCk7XG5cdFx0XHR0aGlzLmhhbmRsZVNjcm9sbCgpO1xuXHRcdH0pO1xuXHR9XG5cblx0Y2FsY3VsYXRlQ29udGFpbmVySGVpZ2h0KCkge1xuXHRcdGlmICh0aGlzLmRpc3BsYXkgPT09IFwibXVsdGlcIikge1xuXHRcdFx0dGhpcy5zdHlsZXMgPSB7fTtcblx0XHRcdGlmICh0aGlzLmV4cGFuZGVkKSB7XG5cdFx0XHRcdGlmICh0aGlzLm1heEV4cGFuZGVkTnVtYmVyT2ZSb3dzID4gMCkge1xuXHRcdFx0XHRcdHRoaXMuc3R5bGVzW1wibWF4LWhlaWdodFwiXSA9IGAke3RoaXMubWF4RXhwYW5kZWROdW1iZXJPZlJvd3MgKiB0aGlzLnJvd0hlaWdodEluUGl4ZWx9cHhgO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0aGlzLm1pbkV4cGFuZGVkTnVtYmVyT2ZSb3dzID4gMCkge1xuXHRcdFx0XHRcdHRoaXMuc3R5bGVzW1wibWluLWhlaWdodFwiXSA9IGAke3RoaXMubWluRXhwYW5kZWROdW1iZXJPZlJvd3MgKiB0aGlzLnJvd0hlaWdodEluUGl4ZWx9cHhgO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAodGhpcy5tYXhDb2xsYXBzZWROdW1iZXJPZlJvd3MgPiAwKSB7XG5cdFx0XHRcdFx0dGhpcy5zdHlsZXNbXCJtYXgtaGVpZ2h0XCJdID0gYCR7dGhpcy5tYXhDb2xsYXBzZWROdW1iZXJPZlJvd3MgKiB0aGlzLnJvd0hlaWdodEluUGl4ZWx9cHhgO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0aGlzLm1pbkNvbGxhcHNlZE51bWJlck9mUm93cyA+IDApIHtcblx0XHRcdFx0XHR0aGlzLnN0eWxlc1tcIm1pbi1oZWlnaHRcIl0gPSBgJHt0aGlzLm1pbkNvbGxhcHNlZE51bWJlck9mUm93cyAqIHRoaXMucm93SGVpZ2h0SW5QaXhlbH1weGA7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwcm90ZWN0ZWQgY2FuRXhwYW5kKCkge1xuXHRcdGlmICh0aGlzLmRpc3BsYXkgPT09IFwibXVsdGlcIikge1xuXHRcdFx0Y29uc3QgaGVpZ2h0ID0gdGhpcy5jb2RlQ29udGVudC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodDtcblx0XHRcdGlmIChcblx0XHRcdFx0dGhpcy5tYXhDb2xsYXBzZWROdW1iZXJPZlJvd3MgPiAwICYmXG5cdFx0XHRcdCh0aGlzLm1heEV4cGFuZGVkTnVtYmVyT2ZSb3dzIDw9IDAgfHxcblx0XHRcdFx0XHR0aGlzLm1heEV4cGFuZGVkTnVtYmVyT2ZSb3dzID4gdGhpcy5tYXhDb2xsYXBzZWROdW1iZXJPZlJvd3MpICYmXG5cdFx0XHRcdGhlaWdodCA+IHRoaXMubWF4Q29sbGFwc2VkTnVtYmVyT2ZSb3dzICogdGhpcy5yb3dIZWlnaHRJblBpeGVsXG5cdFx0XHQpIHtcblx0XHRcdFx0dGhpcy5pc0V4cGFuZGFibGUgPSB0cnVlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5pc0V4cGFuZGFibGUgPSBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKFxuXHRcdFx0XHR0aGlzLmV4cGFuZGVkICYmXG5cdFx0XHRcdHRoaXMubWluRXhwYW5kZWROdW1iZXJPZlJvd3MgPiAwICYmXG5cdFx0XHRcdGhlaWdodCA8PSB0aGlzLm1pbkV4cGFuZGVkTnVtYmVyT2ZSb3dzICogdGhpcy5yb3dIZWlnaHRJblBpeGVsXG5cdFx0XHQpIHtcblx0XHRcdFx0dGhpcy5pc0V4cGFuZGFibGUgPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn1cbiJdfQ==