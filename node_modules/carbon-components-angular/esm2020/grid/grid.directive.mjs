import { ContentChildren, Directive, HostBinding, Input, Optional, SkipSelf } from "@angular/core";
import { Subscription } from "rxjs";
import { GridService } from "./grid.service";
import * as i0 from "@angular/core";
import * as i1 from "./grid.service";
/**
 * [See demo](../../?path=/story/components-grid--basic)
 */
export class GridDirective {
    constructor(gridService) {
        this.gridService = gridService;
        /**
         * Set to `true` to condense the grid
         */
        this.condensed = false;
        /**
         * Set to `true` to use narrow grid
         */
        this.narrow = false;
        /**
         * Set to `true` to use the full width
         */
        this.fullWidth = false;
        this.cssGridEnabled = false;
        this.isSubgrid = false;
        this.subscription = new Subscription();
    }
    /**
     * Set to `true` to use css grid
     */
    set useCssGrid(enable) {
        this.cssGridEnabled = enable;
        this.gridService.updateGridType(enable);
    }
    // Flex grid
    get flexGrid() {
        return !this.cssGridEnabled;
    }
    get flexCondensed() {
        return !this.cssGridEnabled && this.condensed;
    }
    get flexNarrow() {
        return !this.cssGridEnabled && this.narrow;
    }
    get flexFullWidth() {
        return !this.cssGridEnabled && this.fullWidth;
    }
    // CSS Grid
    get ccsGrid() {
        return this.cssGridEnabled && !this.isSubgrid;
    }
    get ccsCondensed() {
        return this.cssGridEnabled && !this.isSubgrid && this.condensed;
    }
    get ccsNarrow() {
        return this.cssGridEnabled && !this.isSubgrid && this.narrow;
    }
    get ccsFullWidth() {
        return this.cssGridEnabled && !this.isSubgrid && this.fullWidth;
    }
    // CSS Sub Grid
    get subGrid() {
        return this.cssGridEnabled && this.isSubgrid;
    }
    get subCondensed() {
        return this.cssGridEnabled && this.isSubgrid && this.condensed;
    }
    get subNarrow() {
        return this.cssGridEnabled && this.isSubgrid && this.narrow;
    }
    get subFullWidth() {
        return this.cssGridEnabled && this.isSubgrid && this.fullWidth;
    }
    ngOnInit() {
        this.subscription = this.gridService.gridObservable.subscribe((isCssGrid) => {
            this.cssGridEnabled = isCssGrid;
        });
    }
    // Make all children grids a sub grid
    set cssGridChildren(list) {
        if (this.cssGridEnabled) {
            list.forEach((grid) => {
                // Prevents initial (parent) grid element from being turned into a subgrid
                if (grid === this) {
                    return;
                }
                grid.isSubgrid = true;
            });
        }
    }
    /**
     * Unsubscribe from Grid Service subscription
     */
    ngOnDestroy() {
        this.subscription.unsubscribe();
    }
}
GridDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.3.0", ngImport: i0, type: GridDirective, deps: [{ token: i1.GridService }], target: i0.ɵɵFactoryTarget.Directive });
GridDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "14.3.0", type: GridDirective, selector: "[cdsGrid], [ibmGrid]", inputs: { condensed: "condensed", narrow: "narrow", fullWidth: "fullWidth", useCssGrid: "useCssGrid" }, host: { properties: { "class.cds--grid": "this.flexGrid", "class.cds--grid--condensed": "this.flexCondensed", "class.cds--grid--narrow": "this.flexNarrow", "class.cds--grid--full-width": "this.flexFullWidth", "class.cds--css-grid": "this.ccsGrid", "class.cds--css-grid--condensed": "this.ccsCondensed", "class.cds--css-grid--narrow": "this.ccsNarrow", "class.cds--css-grid--full-width": "this.ccsFullWidth", "class.cds--subgrid": "this.subGrid", "class.cds--subgrid--condensed": "this.subCondensed", "class.cds--subgrid--narrow": "this.subNarrow", "class.cds--subgrid--wide": "this.subFullWidth" } }, providers: [
        {
            provide: GridService,
            deps: [[new Optional(), new SkipSelf(), GridService]],
            useFactory: (parentService) => {
                return parentService || new GridService();
            }
        }
    ], queries: [{ propertyName: "cssGridChildren", predicate: GridDirective, descendants: true }], ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.3.0", ngImport: i0, type: GridDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: "[cdsGrid], [ibmGrid]",
                    providers: [
                        {
                            provide: GridService,
                            deps: [[new Optional(), new SkipSelf(), GridService]],
                            useFactory: (parentService) => {
                                return parentService || new GridService();
                            }
                        }
                    ]
                }]
        }], ctorParameters: function () { return [{ type: i1.GridService }]; }, propDecorators: { condensed: [{
                type: Input
            }], narrow: [{
                type: Input
            }], fullWidth: [{
                type: Input
            }], useCssGrid: [{
                type: Input
            }], flexGrid: [{
                type: HostBinding,
                args: ["class.cds--grid"]
            }], flexCondensed: [{
                type: HostBinding,
                args: ["class.cds--grid--condensed"]
            }], flexNarrow: [{
                type: HostBinding,
                args: ["class.cds--grid--narrow"]
            }], flexFullWidth: [{
                type: HostBinding,
                args: ["class.cds--grid--full-width"]
            }], ccsGrid: [{
                type: HostBinding,
                args: ["class.cds--css-grid"]
            }], ccsCondensed: [{
                type: HostBinding,
                args: ["class.cds--css-grid--condensed"]
            }], ccsNarrow: [{
                type: HostBinding,
                args: ["class.cds--css-grid--narrow"]
            }], ccsFullWidth: [{
                type: HostBinding,
                args: ["class.cds--css-grid--full-width"]
            }], subGrid: [{
                type: HostBinding,
                args: ["class.cds--subgrid"]
            }], subCondensed: [{
                type: HostBinding,
                args: ["class.cds--subgrid--condensed"]
            }], subNarrow: [{
                type: HostBinding,
                args: ["class.cds--subgrid--narrow"]
            }], subFullWidth: [{
                type: HostBinding,
                args: ["class.cds--subgrid--wide"]
            }], cssGridChildren: [{
                type: ContentChildren,
                args: [GridDirective, { descendants: true }]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JpZC5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvZ3JpZC9ncmlkLmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ04sZUFBZSxFQUNmLFNBQVMsRUFDVCxXQUFXLEVBQ1gsS0FBSyxFQUdMLFFBQVEsRUFFUixRQUFRLEVBQ1IsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNwQyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7OztBQUU3Qzs7R0FFRztBQWFILE1BQU0sT0FBTyxhQUFhO0lBbUV6QixZQUFvQixXQUF3QjtRQUF4QixnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQWxFNUM7O1dBRUc7UUFDTSxjQUFTLEdBQUcsS0FBSyxDQUFDO1FBQzNCOztXQUVHO1FBQ00sV0FBTSxHQUFHLEtBQUssQ0FBQztRQUN4Qjs7V0FFRztRQUNNLGNBQVMsR0FBRyxLQUFLLENBQUM7UUFTbkIsbUJBQWMsR0FBRyxLQUFLLENBQUM7UUFDdkIsY0FBUyxHQUFHLEtBQUssQ0FBQztRQUNsQixpQkFBWSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7SUE0Q0ssQ0FBQztJQXREaEQ7O09BRUc7SUFDSCxJQUFhLFVBQVUsQ0FBQyxNQUFlO1FBQ3RDLElBQUksQ0FBQyxjQUFjLEdBQUcsTUFBTSxDQUFDO1FBQzdCLElBQUksQ0FBQyxXQUFXLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3pDLENBQUM7SUFNRCxZQUFZO0lBQ1osSUFBb0MsUUFBUTtRQUMzQyxPQUFPLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQztJQUM3QixDQUFDO0lBQ0QsSUFBK0MsYUFBYTtRQUMzRCxPQUFPLENBQUMsSUFBSSxDQUFDLGNBQWMsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDO0lBQy9DLENBQUM7SUFDRCxJQUE0QyxV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LElBQUksUUFBUSxFQUFFLEVBQUUsSUFBSSxRQUFRLEVBQUUsRUFBRSxXQUFXLENBQUMsQ0FBQzs0QkFDckQsVUFBVSxFQUFFLENBQUMsYUFBMEIsRUFBRSxFQUFFO2dDQUMxQyxPQUFPLGFBQWEsSUFBSSxJQUFJLFdBQVcsRUFBRSxDQUFDOzRCQUMzQyxDQUFDO3lCQUNEO3FCQUNEO2lCQUNEO2tHQUtTLFNBQVM7c0JBQWpCLEtBQUs7Z0JBSUcsTUFBTTtzQkFBZCxLQUFLO2dCQUlHLFNBQVM7c0JBQWpCLEtBQUs7Z0JBSU8sVUFBVTtzQkFBdEIsS0FBSztnQkFVOEIsUUFBUTtzQkFBM0MsV0FBVzt1QkFBQyxpQkFBaUI7Z0JBR2lCLGFBQWE7c0JBQTNELFdBQVc7dUJBQUMsNEJBQTRCO2dCQUdHLFVBQVU7c0JBQXJELFdBQVc7dUJBQUMseUJBQXlCO2dCQUdVLGFBQWE7c0JBQTVELFdBQVc7dUJBQUMsNkJBQTZCO2dCQUtGLE9BQU87c0JBQTlDLFdBQVc7dUJBQUMscUJBQXFCO2dCQUdpQixZQUFZO3NCQUE5RCxXQUFXO3VCQUFDLGdDQUFnQztnQkFHRyxTQUFTO3NCQUF4RCxXQUFXO3VCQUFDLDZCQUE2QjtnQkFHVSxZQUFZO3NCQUEvRCxXQUFXO3VCQUFDLGlDQUFpQztnQkFLUCxPQUFPO3NCQUE3QyxXQUFXO3VCQUFDLG9CQUFvQjtnQkFHaUIsWUFBWTtzQkFBN0QsV0FBVzt1QkFBQywrQkFBK0I7Z0JBR0csU0FBUztzQkFBdkQsV0FBVzt1QkFBQyw0QkFBNEI7Z0JBR0ksWUFBWTtzQkFBeEQsV0FBVzt1QkFBQywwQkFBMEI7Z0JBYW9CLGVBQWU7c0JBQXpFLGVBQWU7dUJBQUMsYUFBYSxFQUFFLEVBQUUsV0FBVyxFQUFFLElBQUksRUFBRSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG5cdENvbnRlbnRDaGlsZHJlbixcblx0RGlyZWN0aXZlLFxuXHRIb3N0QmluZGluZyxcblx0SW5wdXQsXG5cdE9uRGVzdHJveSxcblx0T25Jbml0LFxuXHRPcHRpb25hbCxcblx0UXVlcnlMaXN0LFxuXHRTa2lwU2VsZlxufSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSBcInJ4anNcIjtcbmltcG9ydCB7IEdyaWRTZXJ2aWNlIH0gZnJvbSBcIi4vZ3JpZC5zZXJ2aWNlXCI7XG5cbi8qKlxuICogW1NlZSBkZW1vXSguLi8uLi8/cGF0aD0vc3RvcnkvY29tcG9uZW50cy1ncmlkLS1iYXNpYylcbiAqL1xuQERpcmVjdGl2ZSh7XG5cdHNlbGVjdG9yOiBcIltjZHNHcmlkXSwgW2libUdyaWRdXCIsXG5cdHByb3ZpZGVyczogW1xuXHRcdHtcblx0XHRcdHByb3ZpZGU6IEdyaWRTZXJ2aWNlLFxuXHRcdFx0ZGVwczogW1tuZXcgT3B0aW9uYWwoKSwgbmV3IFNraXBTZWxmKCksIEdyaWRTZXJ2aWNlXV0sXG5cdFx0XHR1c2VGYWN0b3J5OiAocGFyZW50U2VydmljZTogR3JpZFNlcnZpY2UpID0+IHtcblx0XHRcdFx0cmV0dXJuIHBhcmVudFNlcnZpY2UgfHwgbmV3IEdyaWRTZXJ2aWNlKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRdXG59KVxuZXhwb3J0IGNsYXNzIEdyaWREaXJlY3RpdmUgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG5cdC8qKlxuXHQgKiBTZXQgdG8gYHRydWVgIHRvIGNvbmRlbnNlIHRoZSBncmlkXG5cdCAqL1xuXHRASW5wdXQoKSBjb25kZW5zZWQgPSBmYWxzZTtcblx0LyoqXG5cdCAqIFNldCB0byBgdHJ1ZWAgdG8gdXNlIG5hcnJvdyBncmlkXG5cdCAqL1xuXHRASW5wdXQoKSBuYXJyb3cgPSBmYWxzZTtcblx0LyoqXG5cdCAqIFNldCB0byBgdHJ1ZWAgdG8gdXNlIHRoZSBmdWxsIHdpZHRoXG5cdCAqL1xuXHRASW5wdXQoKSBmdWxsV2lkdGggPSBmYWxzZTtcblx0LyoqXG5cdCAqIFNldCB0byBgdHJ1ZWAgdG8gdXNlIGNzcyBncmlkXG5cdCAqL1xuXHRASW5wdXQoKSBzZXQgdXNlQ3NzR3JpZChlbmFibGU6IGJvb2xlYW4pIHtcblx0XHR0aGlzLmNzc0dyaWRFbmFibGVkID0gZW5hYmxlO1xuXHRcdHRoaXMuZ3JpZFNlcnZpY2UudXBkYXRlR3JpZFR5cGUoZW5hYmxlKTtcblx0fVxuXG5cdHByaXZhdGUgY3NzR3JpZEVuYWJsZWQgPSBmYWxzZTtcblx0cHJpdmF0ZSBpc1N1YmdyaWQgPSBmYWxzZTtcblx0cHJpdmF0ZSBzdWJzY3JpcHRpb24gPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG5cblx0Ly8gRmxleCBncmlkXG5cdEBIb3N0QmluZGluZyhcImNsYXNzLmNkcy0tZ3JpZFwiKSBnZXQgZmxleEdyaWQoKSB7XG5cdFx0cmV0dXJuICF0aGlzLmNzc0dyaWRFbmFibGVkO1xuXHR9XG5cdEBIb3N0QmluZGluZyhcImNsYXNzLmNkcy0tZ3JpZC0tY29uZGVuc2VkXCIpIGdldCBmbGV4Q29uZGVuc2VkKCkge1xuXHRcdHJldHVybiAhdGhpcy5jc3NHcmlkRW5hYmxlZCAmJiB0aGlzLmNvbmRlbnNlZDtcblx0fVxuXHRASG9zdEJpbmRpbmcoXCJjbGFzcy5jZHMtLWdyaWQtLW5hcnJvd1wiKSBnZXQgZmxleE5hcnJvdygpIHtcblx0XHRyZXR1cm4gIXRoaXMuY3NzR3JpZEVuYWJsZWQgJiYgdGhpcy5uYXJyb3c7XG5cdH1cblx0QEhvc3RCaW5kaW5nKFwiY2xhc3MuY2RzLS1ncmlkLS1mdWxsLXdpZHRoXCIpIGdldCBmbGV4RnVsbFdpZHRoKCkge1xuXHRcdHJldHVybiAhdGhpcy5jc3NHcmlkRW5hYmxlZCAmJiB0aGlzLmZ1bGxXaWR0aDtcblx0fVxuXG5cdC8vIENTUyBHcmlkXG5cdEBIb3N0QmluZGluZyhcImNsYXNzLmNkcy0tY3NzLWdyaWRcIikgZ2V0IGNjc0dyaWQoKSB7XG5cdFx0cmV0dXJuIHRoaXMuY3NzR3JpZEVuYWJsZWQgJiYgIXRoaXMuaXNTdWJncmlkO1xuXHR9XG5cdEBIb3N0QmluZGluZyhcImNsYXNzLmNkcy0tY3NzLWdyaWQtLWNvbmRlbnNlZFwiKSBnZXQgY2NzQ29uZGVuc2VkKCkge1xuXHRcdHJldHVybiB0aGlzLmNzc0dyaWRFbmFibGVkICYmICF0aGlzLmlzU3ViZ3JpZCAmJiB0aGlzLmNvbmRlbnNlZDtcblx0fVxuXHRASG9zdEJpbmRpbmcoXCJjbGFzcy5jZHMtLWNzcy1ncmlkLS1uYXJyb3dcIikgZ2V0IGNjc05hcnJvdygpIHtcblx0XHRyZXR1cm4gdGhpcy5jc3NHcmlkRW5hYmxlZCAmJiAhdGhpcy5pc1N1YmdyaWQgJiYgdGhpcy5uYXJyb3c7XG5cdH1cblx0QEhvc3RCaW5kaW5nKFwiY2xhc3MuY2RzLS1jc3MtZ3JpZC0tZnVsbC13aWR0aFwiKSBnZXQgY2NzRnVsbFdpZHRoKCkge1xuXHRcdHJldHVybiB0aGlzLmNzc0dyaWRFbmFibGVkICYmICF0aGlzLmlzU3ViZ3JpZCAmJiB0aGlzLmZ1bGxXaWR0aDtcblx0fVxuXG5cdC8vIENTUyBTdWIgR3JpZFxuXHRASG9zdEJpbmRpbmcoXCJjbGFzcy5jZHMtLXN1YmdyaWRcIikgZ2V0IHN1YkdyaWQoKSB7XG5cdFx0cmV0dXJuIHRoaXMuY3NzR3JpZEVuYWJsZWQgJiYgdGhpcy5pc1N1YmdyaWQ7XG5cdH1cblx0QEhvc3RCaW5kaW5nKFwiY2xhc3MuY2RzLS1zdWJncmlkLS1jb25kZW5zZWRcIikgZ2V0IHN1YkNvbmRlbnNlZCgpIHtcblx0XHRyZXR1cm4gdGhpcy5jc3NHcmlkRW5hYmxlZCAmJiB0aGlzLmlzU3ViZ3JpZCAmJiB0aGlzLmNvbmRlbnNlZDtcblx0fVxuXHRASG9zdEJpbmRpbmcoXCJjbGFzcy5jZHMtLXN1YmdyaWQtLW5hcnJvd1wiKSBnZXQgc3ViTmFycm93KCkge1xuXHRcdHJldHVybiB0aGlzLmNzc0dyaWRFbmFibGVkICYmIHRoaXMuaXNTdWJncmlkICYmIHRoaXMubmFycm93O1xuXHR9XG5cdEBIb3N0QmluZGluZyhcImNsYXNzLmNkcy0tc3ViZ3JpZC0td2lkZVwiKSBnZXQgc3ViRnVsbFdpZHRoKCkge1xuXHRcdHJldHVybiB0aGlzLmNzc0dyaWRFbmFibGVkICYmIHRoaXMuaXNTdWJncmlkICYmIHRoaXMuZnVsbFdpZHRoO1xuXHR9XG5cblx0Y29uc3RydWN0b3IocHJpdmF0ZSBncmlkU2VydmljZTogR3JpZFNlcnZpY2UpIHt9XG5cblx0bmdPbkluaXQoKSB7XG5cdFx0dGhpcy5zdWJzY3JpcHRpb24gPSB0aGlzLmdyaWRTZXJ2aWNlLmdyaWRPYnNlcnZhYmxlLnN1YnNjcmliZSgoaXNDc3NHcmlkOiBib29sZWFuKSA9PiB7XG5cdFx0XHR0aGlzLmNzc0dyaWRFbmFibGVkID0gaXNDc3NHcmlkO1xuXHRcdH0pO1xuXHR9XG5cblx0Ly8gTWFrZSBhbGwgY2hpbGRyZW4gZ3JpZHMgYSBzdWIgZ3JpZFxuXHRAQ29udGVudENoaWxkcmVuKEdyaWREaXJlY3RpdmUsIHsgZGVzY2VuZGFudHM6IHRydWUgfSkgc2V0IGNzc0dyaWRDaGlsZHJlbihsaXN0OiBRdWVyeUxpc3Q8R3JpZERpcmVjdGl2ZT4pIHtcblx0XHRpZiAodGhpcy5jc3NHcmlkRW5hYmxlZCkge1xuXHRcdFx0bGlzdC5mb3JFYWNoKChncmlkKSA9PiB7XG5cdFx0XHRcdC8vIFByZXZlbnRzIGluaXRpYWwgKHBhcmVudCkgZ3JpZCBlbGVtZW50IGZyb20gYmVpbmcgdHVybmVkIGludG8gYSBzdWJncmlkXG5cdFx0XHRcdGlmIChncmlkID09PSB0aGlzKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGdyaWQuaXNTdWJncmlkID0gdHJ1ZTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBVbnN1YnNjcmliZSBmcm9tIEdyaWQgU2VydmljZSBzdWJzY3JpcHRpb25cblx0ICovXG5cdG5nT25EZXN0cm95KCkge1xuXHRcdHRoaXMuc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG5cdH1cbn1cbiJdfQ==